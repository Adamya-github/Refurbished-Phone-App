<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Phone Listings</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>üì± Refurbished Phone Listings</h1>
    <form method="GET" style="margin-bottom: 20px; text-align: center;">
    <input type="text" name="brand" placeholder="Search by brand" style="padding: 5px;">
    <input type="text" name="model" placeholder="Search by model" style="padding: 5px;">
    <button type="submit" style="padding: 5px;">Filter</button>
    <a href="/dashboard" style="margin-left: 10px;">Reset</a>
</form>

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Phone</th>
                <th>Condition</th>
                <th>Price ($)</th>
                <th>Stock</th>
                <th>Directly Sold?</th>
                <th colspan="3">Platforms</th>
            </tr>
        </thead>
        <tbody>
            {% for phone in phones %}
            <tr>
                <td>{{ phone.id }}</td>
                <td>{{ phone.brand }} {{ phone.model }}</td>
                <td>{{ phone.condition }}</td>
                <td>{{ phone.price }}</td>
                <td>{{ phone.stock }}</td>
                <td>{{ phone.sold_directly }}</td>
                {% for p in ['X', 'Y', 'Z'] %}
                <td style="background-color: {% if phone.platforms[p].listed %}#d4edda{% else %}#f8d7da{% endif %};">
                    <strong>{{ p }}</strong><br>
                    Cond: {{ phone.platforms[p].mapped_condition }}<br>
                    Profit: ${{ phone.platforms[p].final_price }}<br>
                    {% if phone.platforms[p].listed %}
                        ‚úÖ Listed
                    {% else %}
                        ‚ùå Not Listed<br>
                        <small>({{ phone.platforms[p].reason }})</small>
                    {% endif %}
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <h2>üìä Summary</h2>
<ul>
    <li>Platform X Listed: {{ phones | selectattr('platforms.X.listed') | select | list | length }}</li>
    <li>Platform Y Listed: {{ phones | selectattr('platforms.Y.listed') | select | list | length }}</li>
    <li>Platform Z Listed: {{ phones | selectattr('platforms.Z.listed') | select | list | length }}</li>
</ul>
</body>
</html>
